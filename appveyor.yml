version: '{build}'
install:
  - ps: Invoke-WebRequest http://kitcreator.rkeene.org/kits/89e1367677d2034c7477184dffc5dd4b23d11674/tclkit.exe -OutFile tclkit.exe
  - cmd: cd .. && git clone https://github.com/tclssg/packer && cd tclssg
build_script:
  - cmd: cd ..\packer && ..\tclssg\tclkit.exe build.tcl %APPVEYOR_REPO_BRANCH% sourceRepository c:\projects\tclssg && cd ..\tclssg
  - cmd: move ..\packer\artifacts .
  - cmd: tclkit.exe ssg.tcl version
test_script:
  - cmd: tclkit.exe tests.tcl
deploy:
  - provider: BinTray
    username: dbohdan
    api_key:
      secure: ozw96x1eb8jSUjZWB3NtAeExwJJh7ELyI/mQed79YG6wRtXKps3D4Efr34b8RQDJ
    subject: dbohdan
    repo: tclssg
    package: starpacks
    publish: true
artifacts:
  - path: artifacts\*
